var ke=Object.defineProperty,He=Object.defineProperties;var Re=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var ie=(d,e,c)=>e in d?ke(d,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):d[e]=c,se=(d,e)=>{for(var c in e||(e={}))Ce.call(e,c)&&ie(d,c,e[c]);if(re)for(var c of re(e))We.call(e,c)&&ie(d,c,e[c]);return d},le=(d,e)=>He(d,Re(e));var qe=(d,e)=>()=>(e||d((e={exports:{}}).exports,e),e.exports);var S=(d,e,c)=>new Promise((f,l)=>{var m=u=>{try{L(c.next(u))}catch(E){l(E)}},w=u=>{try{L(c.throw(u))}catch(E){l(E)}},L=u=>u.done?f(u.value):Promise.resolve(u.value).then(m,w);L((c=c.apply(d,e)).next())});import{H as Te,E as Me,q as $e,j as Fe,m as je,r as Ve,k as Ne,t as ce,u as Pe,v as Xe}from"./codemirror-B1Uo-md0.js";import{a as b,l as Oe,b as Ye}from"./latex-Cab-N9uy.js";var Je=qe(q=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))f(l);new MutationObserver(l=>{for(const m of l)if(m.type==="childList")for(const w of m.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&f(w)}).observe(document,{childList:!0,subtree:!0});function c(l){const m={};return l.integrity&&(m.integrity=l.integrity),l.referrerPolicy&&(m.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?m.credentials="include":l.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function f(l){if(l.ep)return;l.ep=!0;const m=c(l);fetch(l.href,m)}})();const Ue=Te.define([{tag:b.keyword,color:"#090"},{tag:b.operator,color:"#090"},{tag:b.variableName,color:"#090"},{tag:b.typeName,color:"#090"},{tag:b.propertyName,color:"#090"},{tag:b.atom,color:"#090"},{tag:b.number,color:"inherit"},{tag:b.string,color:"inherit"}]);function Ze(d,e){const c=Me.create({doc:"",extensions:[Oe({languageData:{autocomplete:Ye},enableLinting:!1}),$e(Ue),Fe({activateOnTyping:!0}),je(),Ve("e.g. \\frac{1}{\\sqrt{2\\pi}} e^{-x^2/2}"),Ne.of([...Pe,...Xe]),ce.updateListener.of(l=>{l.docChanged&&e&&e(l.state.doc.toString())})]}),f=new ce({state:c,parent:d});return{getValue:()=>f.state.doc.toString(),setValue:l=>{f.dispatch({changes:{from:0,to:f.state.doc.length,insert:l}})},refresh:()=>{},setSize:()=>{},getWrapperElement:()=>f.dom,destroy:()=>f.destroy(),view:f}}document.addEventListener("DOMContentLoaded",()=>{const d=performance.now(),e={latexInput:document.getElementById("latex-input"),exampleLink:document.getElementById("example-link"),saveBtn:document.getElementById("save-btn"),formatToggle:document.getElementById("format-toggle"),twitterShare:document.getElementById("twitter-share"),themeToggle:document.getElementById("theme-toggle"),formatDropdown:document.getElementById("format-dropdown"),zoomSlider:document.getElementById("zoom-slider"),zoomValue:document.getElementById("zoom-value"),resizeHandle:document.getElementById("resize-handle"),layoutToggle:document.getElementById("layout-toggle"),preview:document.getElementById("preview"),formArea:document.querySelector(".form-area"),previewArea:document.querySelector(".preview-area"),container:document.querySelector(".editor-container")},c=768,f=24;let l,m,w,L,u="png";const E=localStorage.getItem("zoomLevel");let p=E?parseFloat(E):1.5;e.zoomSlider.value=p;const x=()=>window.innerWidth<c;function de(t,o){let n;return function(...a){clearTimeout(n),n=setTimeout(()=>t.apply(this,a),o)}}const me=de(D,150),ue=e.latexInput.parentElement,I=document.createElement("div");I.className="codemirror-wrapper",ue.insertBefore(I,e.latexInput),e.latexInput.style.display="none";const fe=Ze(I,me),s=le(se({},fe),{getWrapperElement:()=>I,setSize:(t,o)=>{o!==null&&(I.style.height=`${o}px`),t!==null&&(I.style.width=`${t}px`)}}),C={getValue:()=>s.getValue(),setValue:t=>s.setValue(t)};function T(t,o=!1){const n=document.body.classList.contains("side-by-side"),a=x(),r=o?t.touches[0].clientX:t.clientX,i=o?t.touches[0].clientY:t.clientY;n&&!a?(m=r,L=e.formArea.offsetWidth):(l=i,a?requestAnimationFrame(()=>{j(i)}):w=parseInt(getComputedStyle(s.getWrapperElement()).height,10)),document.documentElement.classList.add("resizing"),e.resizeHandle.classList.add("dragging"),o?(document.addEventListener("touchmove",$,{passive:!1}),document.addEventListener("touchend",A),document.addEventListener("touchcancel",A)):(document.addEventListener("mousemove",M),document.addEventListener("mouseup",V)),t.preventDefault()}function M(t){F(t.clientX,t.clientY,!1)}function $(t){t.touches.length===1&&(t.preventDefault(),F(t.touches[0].clientX,t.touches[0].clientY,!0))}function F(t,o,n){const a=document.body.classList.contains("side-by-side"),r=x();a&&!r?pe(t):(j(o),(r||n)&&requestAnimationFrame(()=>{s.refresh()}))}function j(t){if(x()){const n=e.container.offsetHeight,a=e.container.getBoundingClientRect(),r=Math.max(0,Math.min(t-a.top,n)),i=Math.min(Math.max(r/n,.1),.9);e.formArea.style.flex=`0 0 ${i*100}%`,e.previewArea.style.flex=`0 0 calc(${(1-i)*100}% - ${f}px)`,requestAnimationFrame(()=>{s.refresh()})}else{const n=w+t-l;n>=100&&(s.setSize(null,n),localStorage.setItem("editorHeight",n),document.body.classList.contains("side-by-side")&&(e.container.style.height=n+"px"))}}function pe(t){const o=t-m,n=e.container.offsetWidth,a=e.resizeHandle.offsetWidth,r=n-a,i=Math.min(Math.max((L+o)/r,.2),.8);B(i),localStorage.setItem("sideRatio",i),s.refresh()}function V(){N(),document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",V)}function A(){N(),document.removeEventListener("touchmove",$),document.removeEventListener("touchend",A),document.removeEventListener("touchcancel",A)}function N(){if(document.documentElement.classList.remove("resizing"),e.resizeHandle.classList.remove("dragging"),x()){const t=e.formArea.offsetHeight,o=e.container.offsetHeight,n=t/o;localStorage.setItem("mobileFormRatio",n)}s.refresh()}e.resizeHandle.addEventListener("mousedown",t=>T(t,!1)),e.resizeHandle.addEventListener("touchstart",t=>T(t,!0),{passive:!1});function B(t=.5){const o=e.container.offsetWidth,n=e.resizeHandle.offsetWidth,a=o-n,r=t*a/o*100,i=(1-t)*a/o*100;return e.formArea.style.flex="0 0 "+r+"%",e.previewArea.style.flex="0 0 "+i+"%",{formAreaPercent:r,previewAreaPercent:i}}function k(t){const o=document.getElementById("theme-toggle-icon");o.className=`ph ${t}`}function ge(){const t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;(localStorage.getItem("theme")||(t?"dark":"light"))==="dark"?(document.body.setAttribute("data-theme","dark"),k("ph-sun")):(document.body.removeAttribute("data-theme"),k("ph-moon-stars")),s&&s.refresh()}e.themeToggle.addEventListener("click",()=>{document.body.getAttribute("data-theme")==="dark"?(document.body.removeAttribute("data-theme"),localStorage.setItem("theme","light"),k("ph-moon-stars")):(document.body.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark"),k("ph-sun")),s.refresh(),D()});function P(){if((localStorage.getItem("layout")||"stacked")==="side-by-side"&&!x()){document.body.classList.add("side-by-side");const o=localStorage.getItem("sideRatio"),n=localStorage.getItem("editorHeight")||"400",a=parseInt(n,10);if(s.setSize(null,a),e.container.style.height=a+"px",o){const r=parseFloat(o);B(r)}}else document.body.classList.contains("side-by-side")&&x()&&document.body.classList.remove("side-by-side");s&&setTimeout(()=>{if(s.refresh(),document.body.classList.contains("side-by-side")){const o=s.getWrapperElement();o.style.height="100%"}},10)}e.layoutToggle.addEventListener("click",()=>{if(x())return;if(document.body.classList.contains("side-by-side")){document.body.classList.remove("side-by-side"),localStorage.setItem("layout","stacked"),e.formArea.style.flex="",e.previewArea.style.flex="",e.container.style.display="",e.container.style.height="",e.container.style.flexDirection="";const o=s.getWrapperElement();o.style.height="";const n=localStorage.getItem("editorHeight");n&&s.setSize(null,parseInt(n,10))}else{document.body.classList.add("side-by-side"),localStorage.setItem("layout","side-by-side");const o=parseInt(getComputedStyle(s.getWrapperElement()).height,10);localStorage.setItem("editorHeight",o),e.container.style.display="flex",e.container.style.flexDirection="row",e.container.style.height=o+"px";const n=s.getWrapperElement();n.style.height="100%";const a=localStorage.getItem("sideRatio"),r=a?parseFloat(a):.5;B(r)}s.refresh()});let X=window.innerWidth;window.addEventListener("resize",()=>{const t=window.innerWidth,o=X<c,n=t<c;if(X=t,o!==n)if(n){if(document.body.classList.contains("side-by-side")){localStorage.setItem("wasInSideBySide","true"),document.body.classList.remove("side-by-side"),e.container.style.display="",e.container.style.flexDirection="",e.container.style.height="";const v=s.getWrapperElement();v.style.height=""}const r=localStorage.getItem("mobileFormRatio")||.4,i=parseFloat(r);e.formArea.style.flex=`0 0 ${i*100}%`,e.previewArea.style.flex=`0 0 calc(${(1-i)*100}% - ${f}px)`}else{const a=localStorage.getItem("wasInSideBySide")==="true",r=localStorage.getItem("layout");e.formArea.style.flex="",e.previewArea.style.flex="";const i=localStorage.getItem("editorHeight");if(i&&s.setSize(null,parseInt(i,10)),(a||r==="side-by-side")&&!document.body.classList.contains("side-by-side")){a&&localStorage.removeItem("wasInSideBySide"),document.body.classList.add("side-by-side");const v=parseInt(i||"400",10);e.container.style.display="flex",e.container.style.flexDirection="row",e.container.style.height=v+"px";const y=s.getWrapperElement();if(y.style.height="100%",r==="side-by-side"){const g=localStorage.getItem("sideRatio");if(g){const h=parseFloat(g);B(h)}}}}setTimeout(()=>{s.refresh(),e.formatDropdown.classList.contains("show")&&G()},100)});const O=[String.raw`f(1,m) &= \exp(-m), \\
f(2,m) &= \exp(-2m)
        + (m + m^2)\exp(-3m), \\
f(3,m) &= \exp(-3m)
        + (2m + 4m^2)\exp(-4m)
        + \left(\frac{1}{2}m^2 + 2m^3 + \frac{9}{4}m^4\right)\exp(-5m), \\
f(4,m) &= \exp(-4m)
        + (3m + 9m^2)\exp(-5m)
        + (-2m^2 + 6m^3 + 16m^4)\exp(-6m)
        + \left(\frac16m^3 - \frac72m^4 + \frac{16}3m^5 + \frac{64}{9}m^6\right)\exp(-7m), \\
f(5,m) &= ?
`,String.raw`\mathbf{V}_1 \times \mathbf{V}_2 =
\begin{vmatrix}
   \mathbf{i} & \mathbf{j} & \mathbf{k} \\
   \frac{\partial X}{\partial u} & \frac{\partial Y}{\partial u} & 0 \\
   \frac{\partial X}{\partial v} & \frac{\partial Y}{\partial v} & 0
\end{vmatrix}`,String.raw`P(E) = {n \choose k} p^k (1-p)^{n-k}`,String.raw`\frac{1}{
  \Bigl(\sqrt{\phi\sqrt{5}} - \phi\Bigr)
  e^{\frac{2}{5}\pi}
}
=
1 +
\frac{e^{-2\pi}}{
  1 +
  \frac{e^{-4\pi}}{
    1 +
    \frac{e^{-6\pi}}{
      1 +
      \frac{e^{-8\pi}}{1 + \cdots}
    }
  }
}`,String.raw`1 &+ \frac{q^2}{1-q} \\
  &+ \frac{q^6}{(1-q)(1-q^2)} \\
  &+ \cdots \\
  &= \prod_{j=0}^{\infty} \frac{1}{(1-q^{5j+2})(1-q^{5j+3})} \\
  &\quad \text{for } |q| < 1.`];let W=-1;function Y(){e.zoomSlider.value=p,H(),e.zoomSlider.removeEventListener("input",U),e.zoomSlider.addEventListener("input",U)}function U(){p=parseFloat(e.zoomSlider.value),H(),he()||D(!0),localStorage.setItem("zoomLevel",p)}function he(){try{const t=e.preview.querySelectorAll("mjx-container");return t.length===0?!1:(t.forEach(o=>{o.style.fontSize=`${p*100}%`}),!0)}catch(t){return!1}}function H(){e.zoomValue.textContent=p.toFixed(1)+"x"}Y();let Z="",J=0;function D(t=!1){return S(this,null,function*(){const o=C.getValue().trim();if(o===Z&&p===J&&!t)return;if(Z=o,J=p,!o){e.preview.innerHTML="";return}const a=!o.includes("\\begin{")&&!o.includes("\\end{")?`\\begin{align}
${o}
\\end{align}`:o;e.preview.innerHTML=`$$${a}$$`;try{yield MathJax.typesetPromise([e.preview]),e.preview.querySelectorAll("mjx-container").forEach(i=>{i.style.display="inline-block",i.style.fontSize=`${p*100}%`})}catch(r){console.error("Error rendering LaTeX:",r)}})}function _(t=null){return S(this,null,function*(){yield MathJax.typesetPromise([e.preview]);const o=e.preview.querySelectorAll("mjx-assistive-mml");o.forEach(i=>i.style.setProperty("display","none","important"));const n=document.querySelector(".preview-area");n.classList.add("hide-zoom-controls");const a=e.preview.cloneNode(!0),r=document.createElement("div");r.className="capture-container",r.style.position="absolute",r.style.left="-9999px",r.style.top="0",r.appendChild(a),document.body.appendChild(r);try{a.querySelectorAll("mjx-container").forEach(h=>{h.style.visibility="visible",h.style.display="block",h.style.fontSize=`${p*100}%`});const v=window.getComputedStyle(e.preview.querySelector("mjx-container")).color;return a.querySelectorAll("svg, svg *").forEach(h=>{h.style.stroke=v,h.style.fill=v}),yield html2canvas(a,{scale:2,useCORS:!0,backgroundColor:t,logging:!1})}finally{o.forEach(i=>i.style.removeProperty("display")),n.classList.remove("hide-zoom-controls"),r&&r.parentNode&&document.body.removeChild(r)}})}e.saveBtn.addEventListener("click",()=>{u="png",z(),Q()}),e.formatToggle.addEventListener("click",t=>{t.stopPropagation(),t.preventDefault();const o=e.formatDropdown.classList.contains("show");document.querySelectorAll(".dropdown-content").forEach(a=>a.classList.remove("show")),o||(e.formatDropdown.classList.add("show"),G())});function z(){e.formatDropdown.classList.remove("show"),e.formatDropdown.style.display="none"}function G(){e.formatDropdown.style.visibility="hidden",e.formatDropdown.style.display="block",e.formatDropdown.style.bottom="",e.formatDropdown.style.top="",e.formatDropdown.style.left="",e.formatDropdown.style.right="",e.formatDropdown.style.marginBottom="",e.formatDropdown.style.marginTop="";const t=e.formatDropdown.getBoundingClientRect(),o=e.formatToggle.closest(".save-container").getBoundingClientRect(),a=window.innerHeight-o.bottom,r=t.height,i=t.width;if(a<r+5?(e.formatDropdown.style.bottom="100%",e.formatDropdown.style.top="auto",e.formatDropdown.style.marginBottom="5px"):(e.formatDropdown.style.top="100%",e.formatDropdown.style.bottom="auto",e.formatDropdown.style.marginTop="5px"),e.formatDropdown.style.right="0",o.right-i<5)e.formatDropdown.style.right="auto",e.formatDropdown.style.left="5px";else if(window.innerWidth<480){const y=o.width;if(i>y){const g=(i-y)/2;o.left-g<5?(e.formatDropdown.style.right="auto",e.formatDropdown.style.left="5px"):(e.formatDropdown.style.right="auto",e.formatDropdown.style.left=o.left+(y-i)/2+"px")}}e.formatDropdown.style.visibility="",e.formatDropdown.classList.contains("show")||(e.formatDropdown.style.display="")}document.addEventListener("click",t=>{e.formatDropdown.classList.contains("show")&&!e.formatDropdown.contains(t.target)&&!t.target.matches("#format-toggle")&&!e.formatToggle.contains(t.target)&&z()},!0),e.formatDropdown.querySelectorAll("a").forEach(t=>{t.addEventListener("click",o=>{o.stopPropagation(),o.preventDefault(),u=o.target.getAttribute("data-format"),z(),setTimeout(()=>Q(),10)})}),document.addEventListener("touchstart",t=>{e.formatDropdown.classList.contains("show")&&!e.formatDropdown.contains(t.target)&&!t.target.matches("#format-toggle")&&!e.formatToggle.contains(t.target)&&z()},{passive:!1}),document.addEventListener("keydown",t=>{t.key==="Escape"&&e.formatDropdown.classList.contains("show")&&(z(),t.preventDefault())});function K(t,o){const n=document.createElement("a");n.href=t,n.download=o,n.click()}function ye(){return S(this,null,function*(){if(!C.getValue().trim()){console.error("No LaTeX code to export");return}yield MathJax.typesetPromise([e.preview]);const o=e.preview.querySelector("mjx-container");if(!o){console.error("No MathJax container found");return}const n=o.querySelector("svg");if(!n){console.error("No SVG element found in MathJax output");return}const a=n.getBoundingClientRect(),r=a.width,i=a.height,y=window.getComputedStyle(o).color,g=n.cloneNode(!0);g.querySelectorAll('g[stroke="currentColor"]').forEach(ae=>{ae.setAttribute("stroke",y),ae.setAttribute("fill",y)});const ee=g.getAttribute("viewBox");if(!ee){console.error("SVG has no viewBox");return}const[Se,be,te,oe]=ee.split(" ").map(Number),R=Math.max(te,oe)*.02,xe=Se-R,Le=be-R,Ee=te+2*R,Ie=oe+2*R;g.setAttribute("viewBox",`${xe} ${Le} ${Ee} ${Ie}`);const De=r,ze=i;g.setAttribute("width",De),g.setAttribute("height",ze),g.setAttribute("xmlns","http://www.w3.org/2000/svg");const Ae=new XMLSerializer().serializeToString(g),Be=new Blob([Ae],{type:"image/svg+xml"}),ne=URL.createObjectURL(Be);K(ne,"latex-image.svg"),URL.revokeObjectURL(ne)})}function we(){return S(this,null,function*(){let t=null;if(u==="jpeg"){const r=document.querySelector(".preview-area");t=window.getComputedStyle(r).backgroundColor}const o=u==="jpeg"?"image/jpeg":"image/png",a=(yield _(t)).toDataURL(o);K(a,`latex-image.${u}`)})}function Q(){return S(this,null,function*(){try{u==="svg"?yield ye():yield we()}catch(t){console.error("Error saving image:",t),console.error("Format:",u)}})}e.twitterShare.addEventListener("click",()=>S(q,null,function*(){try{(yield _(null)).toBlob(o=>S(q,null,function*(){if(!o){alert("Failed to capture image.");return}const n=new File([o],"latex-image.png",{type:"image/png"});if(navigator.canShare&&navigator.canShare({files:[n]}))try{yield navigator.share({files:[n],title:"LaTeX Image",text:"Check out my LaTeX equation rendered as an image!"})}catch(a){console.error("Error sharing",a)}else alert("Your browser does not support direct image sharing. Please save the image and share manually.")}),"image/png")}catch(t){console.error("Error sharing image:",t),alert("Failed to share image.")}})),e.exampleLink.addEventListener("click",t=>{t.preventDefault(),W=(W+1)%O.length,C.setValue(O[W].trim()),D()}),H(),window.addEventListener("pageshow",t=>{const o=localStorage.getItem("zoomLevel");o?(p=parseFloat(o),e.zoomSlider.value=p):p=parseFloat(e.zoomSlider.value),H(),D(),Y(),t.persisted&&(P(),setTimeout(()=>{s.refresh()},100))}),ge(),P(),setTimeout(()=>{if(s.refresh(),document.body.classList.contains("side-by-side")){const t=s.getWrapperElement();t.style.height="100%",e.container.style.display="flex"}},50),D();const ve=performance.now()-d;(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&console.log(`LaTeX2PNG initialized in ${ve.toFixed(2)}ms`),(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(window.checkLayout=function(){console.log("Layout state:",{isSideBySide:document.body.classList.contains("side-by-side"),containerDisplay:getComputedStyle(e.container).display,containerHeight:e.container.style.height,editorHeight:getComputedStyle(s.getWrapperElement()).height,savedLayout:localStorage.getItem("layout"),savedHeight:localStorage.getItem("editorHeight"),savedRatio:localStorage.getItem("sideRatio")})})})});export default Je();
